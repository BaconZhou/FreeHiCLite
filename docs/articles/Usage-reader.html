<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Usage-reader • FreeHiCLite</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Usage-reader">
<meta property="og:description" content="FreeHiCLite">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FreeHiCLite</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Usage-FreeHiC.html">Usage-FreeHiC</a>
    </li>
    <li>
      <a href="../articles/Usage-reader.html">Usage-reader</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/yezhengSTAT/FreeHiC/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Usage-reader</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/yezhengSTAT/FreeHiC/blob/master/vignettes/Usage-reader.Rmd"><code>vignettes/Usage-reader.Rmd</code></a></small>
      <div class="hidden name"><code>Usage-reader.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The <a href="https://github.com/aidenlab/juicer/wiki/Data"><code>.hic</code></a> file is a highly compressed binary file, which is developed in the <a href="http://aidenlab.org/">Aiden Lab</a>. Which can be used in <a href="https://aidenlab.org/juicebox/">juicebox</a> for contact matrix visualization.</p>
<p>The <code>.hic</code> file is formatted as <a href="https://github.com/aidenlab/Juicebox/blob/master/HiCFormatV8.md">HiC Format</a>. To program with <code>.hic</code> file, they provide <a href="https://github.com/aidenlab/straw">straw</a> and <a href="https://github.com/aidenlab/juicer/wiki/Data-Extraction">Dump</a> to extract the information from the <code>.hic</code> file. The <code><a href="../reference/readJuicer.html">FreeHiCLite::readJuicer()</a></code> adopts most from the C++ version of straw.</p>
<p>The <code>.hic</code> file only contains two units of resolution, and each unit contains a fix set of resolutions.</p>
<ol style="list-style-type: decimal">
<li>Base-pair-delimited resolutions (<strong>BP</strong>): 2.5M, 1M, 500K, 250K, 100K, 50K, 25K, 10K, and 5K.</li>
<li>Fragment-delimited resolutions (<strong>FRAG</strong>): 500f, 250f, 100f, 50f, 20f, 5f, 2f, 1f.</li>
</ol>
<p>The following figure shows how juicebox visualized a human genome at chromosome 1.</p>
<p><img src="gm12878_chr1.png"><!-- --></p>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">FreeHiCLite</span>)</pre></body></html></div>
<div id="file-type" class="section level3">
<h3 class="hasAnchor">
<a href="#file-type" class="anchor"></a>File type</h3>
<p>The ‘FreeHiCLite’ can access two type of hic file, one is local file, the other is remote file. The remote file lists can be found in <a href="http://aidenlab.org/data.html">http://aidenlab.org/data.html</a>.</p>
</div>
<div id="read-basic-information" class="section level3">
<h3 class="hasAnchor">
<a href="#read-basic-information" class="anchor"></a>Read basic information</h3>
<p>To access basic information about a <code>.hic</code> file. We can use function <code><a href="../reference/readJuicerInformation.html">readJuicerInformation()</a></code>. For example, we want to know which <em>genomeID</em> and what are the available <em>resolutions</em> of a remote file locates in: <code>https://hicfiles.s3.amazonaws.com/hiseq/gm12878/in-situ/combined.hic</code>. Besides, it will also extract the chromosomes sizes.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co">## Remote file location. The reomte file include downloading, it may take a while</span>
<span class="no">remoteFilePath</span> <span class="kw">=</span> <span class="st">"https://hicfiles.s3.amazonaws.com/hiseq/gm12878/in-situ/combined.hic"</span>
<span class="no">remoteInfo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/readJuicerInformation.html">readJuicerInformation</a></span>(<span class="no">remoteFilePath</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; File: https://hicfiles.s3.amazonaws.com/hiseq/gm12878/in-situ/combined.hic</span>
<span class="co">#&gt; GenomId:</span>
<span class="co">#&gt; Available pair: 10_10, 10_11, 10_12, 10_13, 10_14, 10_15, 10_16, 10_17, 10_18, 10_19, 10_20, 10_21, 10_22, 10_23, 10_24, 10_25, 11_11, 11_12, 11_13, 11_14, 11_15, 11_16, 11_17, 11_18, 11_19, 11_20, 11_21, 11_22, 11_23, 11_24, 11_25, 12_12, 12_13, 12_14, 12_15, 12_16, 12_17, 12_18, 12_19, 12_20, 12_21, 12_22, 12_23, 12_24, 12_25, 13_13, 13_14, 13_15, 13_16, 13_17, 13_18, 13_19, 13_20, 13_21, 13_22, 13_23, 13_24, 13_25, 14_14, 14_15, 14_16, 14_17, 14_18, 14_19, 14_20, 14_21, 14_22, 14_23, 14_24, 14_25, 15_15, 15_16, 15_17, 15_18, 15_19, 15_20, 15_21, 15_22, 15_23, 15_24, 15_25, 16_16, 16_17, 16_18, 16_19, 16_20, 16_21, 16_22, 16_23, 16_24, 16_25, 17_17, 17_18, 17_19, 17_20, 17_21, 17_22, 17_23, 17_24, 17_25, 18_18, 18_19, 18_20, 18_21, 18_22, 18_23, 18_24, 18_25, 19_19, 19_20, 19_21, 19_22, 19_23, 19_24, 19_25, 1_1, 1_10, 1_11, 1_12, 1_13, 1_14, 1_15, 1_16, 1_17, 1_18, 1_19, 1_2, 1_20, 1_21, 1_22, 1_23, 1_24, 1_25, 1_3, 1_4, 1_5, 1_6, 1_7, 1_8, 1_9, 20_20, 20_21, 20_22, 20_23, 20_24, 20_25, 21_21, 21_22, 21_23, 21_24, 21_25, 22_22, 22_23, 22_24, 22_25, 23_23, 23_24, 23_25, 24_24, 24_25, 25_25, 2_10, 2_11, 2_12, 2_13, 2_14, 2_15, 2_16, 2_17, 2_18, 2_19, 2_2, 2_20, 2_21, 2_22, 2_23, 2_24, 2_25, 2_3, 2_4, 2_5, 2_6, 2_7, 2_8, 2_9, 3_10, 3_11, 3_12, 3_13, 3_14, 3_15, 3_16, 3_17, 3_18, 3_19, 3_20, 3_21, 3_22, 3_23, 3_24, 3_25, 3_3, 3_4, 3_5, 3_6, 3_7, 3_8, 3_9, 4_10, 4_11, 4_12, 4_13, 4_14, 4_15, 4_16, 4_17, 4_18, 4_19, 4_20, 4_21, 4_22, 4_23, 4_24, 4_25, 4_4, 4_5, 4_6, 4_7, 4_8, 4_9, 5_10, 5_11, 5_12, 5_13, 5_14, 5_15, 5_16, 5_17, 5_18, 5_19, 5_20, 5_21, 5_22, 5_23, 5_24, 5_25, 5_5, 5_6, 5_7, 5_8, 5_9, 6_10, 6_11, 6_12, 6_13, 6_14, 6_15, 6_16, 6_17, 6_18, 6_19, 6_20, 6_21, 6_22, 6_23, 6_24, 6_25, 6_6, 6_7, 6_8, 6_9, 7_10, 7_11, 7_12, 7_13, 7_14, 7_15, 7_16, 7_17, 7_18, 7_19, 7_20, 7_21, 7_22, 7_23, 7_24, 7_25, 7_7, 7_8, 7_9, 8_10, 8_11, 8_12, 8_13, 8_14, 8_15, 8_16, 8_17, 8_18, 8_19, 8_20, 8_21, 8_22, 8_23, 8_24, 8_25, 8_8, 8_9, 9_10, 9_11, 9_12, 9_13, 9_14, 9_15, 9_16, 9_17, 9_18, 9_19, 9_20, 9_21, 9_22, 9_23, 9_24, 9_25, 9_9.</span>
<span class="co">#&gt; Hi-C resolution:</span>
<span class="co">#&gt;     BP: 2500000, 1000000, 500000, 250000, 100000, 50000, 25000, 10000, 5000, 1000.</span>
<span class="co">#&gt;     FRAG: 500, 200, 100, 50, 20, 5, 2, 1.</span></pre></body></html></div>
<table class="table kable_wrapper">
<caption>
Chromsome size in the file.
</caption>
<tbody><tr>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">chromosome</th>
<th align="right">size</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">249250621</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="right">135534747</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="right">135006516</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="right">133851895</td>
</tr>
<tr class="odd">
<td align="left">13</td>
<td align="right">115169878</td>
</tr>
<tr class="even">
<td align="left">14</td>
<td align="right">107349540</td>
</tr>
<tr class="odd">
<td align="left">15</td>
<td align="right">102531392</td>
</tr>
<tr class="even">
<td align="left">16</td>
<td align="right">90354753</td>
</tr>
<tr class="odd">
<td align="left">17</td>
<td align="right">81195210</td>
</tr>
<tr class="even">
<td align="left">18</td>
<td align="right">78077248</td>
</tr>
<tr class="odd">
<td align="left">19</td>
<td align="right">59128983</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">243199373</td>
</tr>
<tr class="odd">
<td align="left">20</td>
<td align="right">63025520</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table"><tbody></tbody></table>
</td>
<td>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">chromosome</th>
<th align="right">size</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>14</td>
<td align="left">21</td>
<td align="right">48129895</td>
</tr>
<tr class="even">
<td>15</td>
<td align="left">22</td>
<td align="right">51304566</td>
</tr>
<tr class="odd">
<td>16</td>
<td align="left">3</td>
<td align="right">198022430</td>
</tr>
<tr class="even">
<td>17</td>
<td align="left">4</td>
<td align="right">191154276</td>
</tr>
<tr class="odd">
<td>18</td>
<td align="left">5</td>
<td align="right">180915260</td>
</tr>
<tr class="even">
<td>19</td>
<td align="left">6</td>
<td align="right">171115067</td>
</tr>
<tr class="odd">
<td>20</td>
<td align="left">7</td>
<td align="right">159138663</td>
</tr>
<tr class="even">
<td>21</td>
<td align="left">8</td>
<td align="right">146364022</td>
</tr>
<tr class="odd">
<td>22</td>
<td align="left">9</td>
<td align="right">141213431</td>
</tr>
<tr class="even">
<td>23</td>
<td align="left">all</td>
<td align="right">3098789</td>
</tr>
<tr class="odd">
<td>24</td>
<td align="left">mt</td>
<td align="right">16569</td>
</tr>
<tr class="even">
<td>25</td>
<td align="left">x</td>
<td align="right">155270560</td>
</tr>
<tr class="odd">
<td>26</td>
<td align="left">y</td>
<td align="right">59373566</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody>
</table>
<p>We can also use it to a local file</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co">## Local file location</span>
<span class="no">localFilePath</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"example.hic"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"FreeHiCLite"</span>)
<span class="no">localInfo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/readJuicerInformation.html">readJuicerInformation</a></span>(<span class="no">localFilePath</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; File: /Library/Frameworks/R.framework/Versions/4.0/Resources/library/FreeHiCLite/extdata/example.hic</span>
<span class="co">#&gt; GenomId:</span>
<span class="co">#&gt; Available pair: 1_1, 1_2, 1_3, 2_2, 2_3, 3_3.</span>
<span class="co">#&gt; Hi-C resolution:</span>
<span class="co">#&gt;     BP: 2500000, 500000, 5000.</span>
<span class="co">#&gt;     FRAG not available.</span></pre></body></html></div>
</div>
<div id="read-a-resolution" class="section level3">
<h3 class="hasAnchor">
<a href="#read-a-resolution" class="anchor"></a>Read a resolution</h3>
<p>The ‘FreeHiCLite’ package provide a <code><a href="../reference/readJuicer.html">readJuicer()</a></code> function to read file of chromosomes at a specific resolution.</p>
<p>The <code>example.hic</code> data is a small customized file with only three resolutions in BP.</p>
<div id="by-chromosomes" class="section level4">
<h4 class="hasAnchor">
<a href="#by-chromosomes" class="anchor"></a>By chromosomes</h4>
<p>If you input <code>chromosomes</code> and set <code>pairs = NULL</code>, <code><a href="../reference/readJuicer.html">readJuicer()</a></code> will read all the possible pair for the hic file.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co">## Chromosomes needs to be extract</span>
<span class="no">chromosomes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"chr3"</span>)

<span class="co">## Pairs needs to be extract</span>
<span class="no">pairs</span> <span class="kw">=</span> <span class="kw">NULL</span>
<span class="no">unit</span> <span class="kw">=</span> <span class="st">"BP"</span>
<span class="no">resolution</span> <span class="kw">=</span> <span class="fl">500000L</span>

<span class="no">dat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/readJuicer.html">readJuicer</a></span>(<span class="kw">file</span><span class="kw">=</span><span class="no">localFilePath</span>, <span class="kw">chromosomes</span><span class="kw">=</span><span class="no">chromosomes</span>, <span class="kw">pairs</span> <span class="kw">=</span> <span class="no">pairs</span>, <span class="kw">unit</span><span class="kw">=</span><span class="no">unit</span>, <span class="kw">resolution</span><span class="kw">=</span><span class="no">resolution</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">dat</span>)
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ contact    :List of 6</span>
<span class="co">#&gt;   ..$ 1_1: int [1:87158, 1:3] 500000 500000 1000000 500000 1000000 1500000 500000 1000000 1500000 2000000 ...</span>
<span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. .. ..$ : NULL</span>
<span class="co">#&gt;   .. .. ..$ : chr [1:3] "x" "y" "counts"</span>
<span class="co">#&gt;   ..$ 1_2: int [1:69341, 1:3] 2500000 4000000 4500000 5000000 5500000 6000000 7000000 8500000 9500000 10000000 ...</span>
<span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. .. ..$ : NULL</span>
<span class="co">#&gt;   .. .. ..$ : chr [1:3] "x" "y" "counts"</span>
<span class="co">#&gt;   ..$ 1_3: int [1:60301, 1:3] 2500000 4000000 6500000 9000000 12500000 13500000 14000000 15500000 18000000 19000000 ...</span>
<span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. .. ..$ : NULL</span>
<span class="co">#&gt;   .. .. ..$ : chr [1:3] "x" "y" "counts"</span>
<span class="co">#&gt;   ..$ 2_2: int [1:104782, 1:3] 0 0 500000 0 500000 1000000 0 500000 1000000 1500000 ...</span>
<span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. .. ..$ : NULL</span>
<span class="co">#&gt;   .. .. ..$ : chr [1:3] "x" "y" "counts"</span>
<span class="co">#&gt;   ..$ 2_3: int [1:57664, 1:3] 0 1000000 1500000 2000000 4500000 5000000 6000000 6500000 7500000 8500000 ...</span>
<span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. .. ..$ : NULL</span>
<span class="co">#&gt;   .. .. ..$ : chr [1:3] "x" "y" "counts"</span>
<span class="co">#&gt;   ..$ 3_3: int [1:72273, 1:3] 0 0 500000 0 500000 1000000 0 500000 1000000 1500000 ...</span>
<span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. .. ..$ : NULL</span>
<span class="co">#&gt;   .. .. ..$ : chr [1:3] "x" "y" "counts"</span>
<span class="co">#&gt;  $ information:List of 4</span>
<span class="co">#&gt;   ..$ genomeID       : chr "hg19"</span>
<span class="co">#&gt;   ..$ resolution     :List of 2</span>
<span class="co">#&gt;   .. ..$ BP  : int [1:3] 2500000 500000 5000</span>
<span class="co">#&gt;   .. ..$ FRAG: int(0) </span>
<span class="co">#&gt;   ..$ pairs          : chr [1:6] "1_1" "1_2" "1_3" "2_2" ...</span>
<span class="co">#&gt;   ..$ chromosomeSizes:'data.frame':  26 obs. of  2 variables:</span>
<span class="co">#&gt;   .. ..$ chromosome: chr [1:26] "1" "10" "11" "12" ...</span>
<span class="co">#&gt;   .. ..$ size      : int [1:26] 249250621 135534747 135006516 133851895 115169878 107349540 102531392 90354753 81195210 78077248 ...</span>
<span class="co">#&gt;  $ settings   :List of 4</span>
<span class="co">#&gt;   ..$ unit       : chr "BP"</span>
<span class="co">#&gt;   ..$ resolution : int 500000</span>
<span class="co">#&gt;   ..$ chromosomes: chr [1:3] "chr1" "chr2" "chr3"</span>
<span class="co">#&gt;   ..$ file       : chr "/Library/Frameworks/R.framework/Versions/4.0/Resources/library/FreeHiCLite/extdata/example.hic"</span>
<span class="co">#&gt;  - attr(*, "class")= chr [1:2] "juicer" "freehic"</span></pre></body></html></div>
<p>The result object contains</p>
<ul>
<li>
<code>contact</code>: A list of contact matrixes. For each matrix, the name stands for <code>chrA_chrB</code>, and matrix has has format (x, y, count).</li>
</ul>
<table class="table">
<thead><tr class="header">
<th align="left">x</th>
<th align="left">y</th>
<th align="right">counts</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">500000</td>
<td align="left">500000</td>
<td align="right">384</td>
</tr>
<tr class="even">
<td align="left">500000</td>
<td align="left">1000000</td>
<td align="right">231</td>
</tr>
<tr class="odd">
<td align="left">1000000</td>
<td align="left">1000000</td>
<td align="right">1272</td>
</tr>
<tr class="even">
<td align="left">500000</td>
<td align="left">1500000</td>
<td align="right">47</td>
</tr>
<tr class="odd">
<td align="left">1000000</td>
<td align="left">1500000</td>
<td align="right">373</td>
</tr>
<tr class="even">
<td align="left">1500000</td>
<td align="left">1500000</td>
<td align="right">1665</td>
</tr>
</tbody>
</table>
</div>
<div id="by-pairs" class="section level4">
<h4 class="hasAnchor">
<a href="#by-pairs" class="anchor"></a>By pairs</h4>
<p>You can also just input <code>pairs</code>. The function will only use <code>pairs</code> if it is not <code>NULL</code>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co">## Chromosomes needs to be extract</span>
<span class="no">chromosomes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"chr3"</span>)

<span class="co">## Pairs needs to be extract</span>
<span class="no">pairs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1_1"</span>)
<span class="no">unit</span> <span class="kw">=</span> <span class="st">"BP"</span>
<span class="no">resolution</span> <span class="kw">=</span> <span class="fl">500000L</span>

<span class="no">dat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/readJuicer.html">readJuicer</a></span>(<span class="kw">file</span><span class="kw">=</span><span class="no">localFilePath</span>, <span class="kw">chromosomes</span><span class="kw">=</span><span class="no">chromosomes</span>, <span class="kw">pairs</span> <span class="kw">=</span> <span class="no">pairs</span>, <span class="kw">unit</span><span class="kw">=</span><span class="no">unit</span>, <span class="kw">resolution</span><span class="kw">=</span><span class="no">resolution</span>)

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">dat</span>$<span class="no">contact</span>)
<span class="co">#&gt; [1] "1_1"</span></pre></body></html></div>
</div>
</div>
<div id="write-to-disk" class="section level3">
<h3 class="hasAnchor">
<a href="#write-to-disk" class="anchor"></a>Write to disk</h3>
<p>We provide two functions: <code><a href="../reference/convertJuicer.html">convertJuicer()</a></code> and <code><a href="../reference/writeJuicer.html">writeJuicer()</a></code> to write the resulting contact matrix into a <a href="https://github.com/aidenlab/juicer/wiki/Pre#short-with-score-format">short with score format</a></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">cs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/convertJuicer.html">convertJuicer</a></span>(<span class="no">dat</span><span class="kw">[[</span><span class="st">'contact'</span>]]<span class="kw">[[</span><span class="st">'1_1'</span>]], <span class="st">'1'</span>, <span class="st">'1'</span>)</pre></body></html></div>
<p>The result looks like the following table.</p>
<table class="table">
<thead><tr class="header">
<th align="left">str1</th>
<th align="left">chr1</th>
<th align="left">pos1</th>
<th align="left">frag1</th>
<th align="left">str2</th>
<th align="left">chr2</th>
<th align="left">pos2</th>
<th align="left">frag2</th>
<th align="left">score</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">1</td>
<td align="left">500000</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">500000</td>
<td align="left">1</td>
<td align="left">384</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">1</td>
<td align="left">500000</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1000000</td>
<td align="left">1</td>
<td align="left">231</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1000000</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1000000</td>
<td align="left">1</td>
<td align="left">1272</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">1</td>
<td align="left">500000</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1500000</td>
<td align="left">1</td>
<td align="left">47</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1000000</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1500000</td>
<td align="left">1</td>
<td align="left">373</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1500000</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1500000</td>
<td align="left">1</td>
<td align="left">1665</td>
</tr>
</tbody>
</table>
<p>We can also use <code><a href="../reference/writeJuicer.html">writeJuicer()</a></code> to directly write to file.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../reference/writeJuicer.html">writeJuicer</a></span>(<span class="no">dat</span><span class="kw">[[</span><span class="st">'contact'</span>]], <span class="kw">file</span> <span class="kw">=</span> <span class="st">'test.txt'</span>)</pre></body></html></div>
<p>After you write to disk, you can run <a href="https://github.com/aidenlab/juicer/">juicer</a>’s <a href="https://github.com/aidenlab/juicer/wiki/Pre">Pre</a> function to produce a <code>.hic</code> file for display purpose. Here we display an example code of running Pre command.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="ex">java</span> -jar /path/to/juicer_tool.jar pre test.txt test.hic genomeID </a></code></pre></div>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ol style="list-style-type: decimal">
<li>Neva C. Durand, Muhammad S. Shamim, Ido Machol, Suhas S. P. Rao, Miriam H. Huntley, Eric S. Lander, and Erez Lieberman Aiden. <a href="https://www.cell.com/cell-systems/fulltext/S2405-4712(16)30219-8">“Juicer provides a one-click system for analyzing loop-resolution Hi-C experiments.”</a> Cell Systems 3(1), 2016.</li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Peigen Zhou, Ye Zheng, Sunduz Keles.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
